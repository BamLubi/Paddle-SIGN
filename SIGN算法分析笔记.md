# SIGN 算法分析笔记

**背景**：以往的研究考虑了每一对特征之间的交互，但是某些特征交互与推荐结果的相关性不大，因此可能引入噪声，降低推荐结果准确性。

**主要工作**：在数据集众多特征中寻找有益的特征交互，使用图神经网络 GNN 建模每个样本的特征，使用基于 L0 正则化的边预测实现特征交互的自动检测。

**相关工作**：

- **GNN**：用于学习单个实体与整体的关系。作者将特征交互与图中的边联系起来，利用 GNN 的关系推理能力来对**_特征交互对预测结果的贡献_**进行建模。
- **L0 正则化**：通过惩罚非 0 参数来稀疏模型，常用来压缩神经网络。作者利用 L0 正则化来**_限制特征图中检测到的边 的数量_**，以进行有益的特征交互检测。

## 模型描述

<img src="https://picgo-1256052225.cos.ap-guangzhou.myqcloud.com/img/202201241713641.png" style="zoom: 50%;" />

对于一条样本，作者将该样本的所有特征$X$当成图的顶点，学习一个图$G(X,E),E=\{e_{ij}\}_{i,}j\in X,e_{ij} \in \{0,1\}$。边代表着两个特征（顶点）之间是否存在特征交互，边的权重代表重要性。

模型共有两个模块：L0 边预估模块和 SIGN 模块。

**L0 边预估模块**：通过矩阵分解对边进行预测，定义边预估函数$f_{ep}$（edge prediction）函数判断两个顶点$i$和$j$之间存在边。

$$
f_{ep}(v_i^e,v_j^e)=W_2^eReLU(W_1^e(v_i^e \odot v_j^e)+b_1^e)+b_2^e,f_{ep}\in \{0,1\}
$$

**SIGN 模块**：

- 定义**特征交互函数$h$**，计算两个特征交互后新的向量表示：

$$
h(v_i,v_j)=W_2^hReLU(W_1^h(v_i \odot v_j)+b_1^h)+b_2^h
$$

- 使用**线性聚合函数$\psi$**来聚合该节点和邻居节点之间所有的分析结果，以此更新每一个节点。

- 对于更新之后的节点，使用**线性加权函数$g$**将其转换成数值。

- 再使用**线性聚合函数$\phi$**来聚合整个图的所有顶点的数值，获得最终的输出。

则最终的**预估方程**为：

$$
f_{LS}(G;\omega,\theta)=\phi(\{
g(
\psi(
\{ f_{ep}(v_i^e,v_j^e) h(u_i, u_j) \}_{j\in X}
)
)
\}_{i\in X})
$$

定义**损失函数**：

$$
\mathfrak{L}(\theta,\omega)=\frac{1}{N}\sum_{n=1}^{N}(\mathfrak{L}(F_{LS}(G_n;\omega,\theta),y_n)+\lambda_1\sum_{i,j\in X_n}(\pi_n)_{ij}+\lambda_2||z_n||_2) \\
其中(\pi_n)_{ij}表示(e_n')_{ij}=1的概率，z_{ij}表示h(u_i,u_j)的输出
$$
